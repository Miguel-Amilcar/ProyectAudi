@model ProyectAudi.ViewModels.Usuario.DetailsViewModel

@{
    ViewData["Title"] = "Detalles del Usuario";
    var permisos = ViewBag.Permisos as HashSet<string> ?? new HashSet<string>();
}

<h2 class="mb-4 text-primary">
    <i class="bi bi-person-lines-fill"></i> Detalles del Usuario
</h2>

<div class="card shadow-sm border-0 mb-4">
    <div class="card-header bg-primary text-white">
        <strong><i class="bi bi-info-circle-fill me-1"></i> Información general</strong>
    </div>
    <div class="card-body">
        <div class="row gy-3">
            <div class="col-md-6">
                <strong>CUI:</strong><br />
                <span class="text-muted">@Model.CUI</span>
            </div>
            <div class="col-md-6">
                <strong>Nombre completo:</strong><br />
                <span class="text-muted">
                    @(string.Join(" ", new[] {
                    Model.PRIMERNOMBRE,
                    Model.SEGUNDONOMBRE,
                    Model.TERCERNOMBRE,
                    Model.PRIMERAPELLIDO,
                    Model.SEGUNDOAPELLIDO,
                    Model.APELLIDOCASADA
                    }.Where(n => !string.IsNullOrWhiteSpace(n))))
                </span>
            </div>
            <div class="col-md-6">
                <strong>Fecha de nacimiento:</strong><br />
                <span class="text-muted">@Model.FECHA_NACIMIENTO?.ToString("dd/MM/yyyy")</span>
            </div>
            <div class="col-md-6">
                <strong>Teléfono:</strong><br />
                <span class="text-muted">@Model.TELEFONO"</span>
            </div>
            <div class="col-md-6">
                <strong>Dirección:</strong><br />
                <span class="text-muted">@Model.DIRECCION</span>
            </div>
            <div class="col-md-6">
                <strong>Correo electrónico:</strong><br />
                <span class="text-muted">@Model.USUARIO_CORREO</span>
            </div>
            <div class="col-md-6">
                <strong>Rol asignado:</strong><br />
                <span class="badge bg-success">@Model.RolNombre</span>
            </div>
            <div class="col-md-6">
                <strong>Estado:</strong><br />
                @{
                    var estadoTexto = Model.ESTADO_TINY switch
                    {
                        0 => "Inactivo",
                        1 => "Activo",
                        2 => "Suspendido",
                        _ => "Desconocido"
                    };

                    var estadoClase = Model.ESTADO_TINY switch
                    {
                        0 => "badge bg-secondary",
                        1 => "badge bg-success",
                        2 => "badge bg-warning text-dark",
                        _ => "badge bg-dark"
                    };
                }
                <span class="@estadoClase px-2 py-1">@estadoTexto</span>
            </div>
        </div>

        <hr class="my-4" />

        <div class="row gy-3">
            <div class="col-md-6">
                <strong>Creado por:</strong><br />
                <span class="text-muted">@Model.CREADO_POR</span>
            </div>
            <div class="col-md-6">
                <strong>Fecha de creación:</strong><br />
                <span class="text-muted">@Model.FECHA_CREACION?.ToString("dd/MM/yyyy HH:mm")</span>
            </div>
            <div class="col-md-6">
                <strong>Modificado por:</strong><br />
                <span class="text-muted">@Model.MODIFICADO_POR</span>
            </div>
            <div class="col-md-6">
                <strong>Fecha de modificación:</strong><br />
                <span class="text-muted">@Model.FECHA_MODIFICACION?.ToString("dd/MM/yyyy HH:mm")</span>
            </div>
        </div>
    </div>
</div>

@if (permisos.Contains("EDITAR"))
{
    <a asp-action="Edit" asp-route-id="@Model.USUARIO_ID" class="btn btn-warning">
        <i class="bi bi-pencil-square"></i> Editar
    </a>
}
<a asp-action="Index" class="btn btn-secondary">
    <i class="bi bi-arrow-left-circle"></i> Volver
</a>
