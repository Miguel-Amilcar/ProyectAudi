@model List<ProyectAudi.Modelspartial.Correos.CorreoEnviadoViewModel> // ✅ Correcto


@{
    ViewData["Title"] = "Correos enviados";
    var permisos = ViewBag.Permisos as HashSet<string> ?? new HashSet<string>();
    var usuarioActivo = ViewBag.UsuarioActivo as string ?? "Usuario desconocido";
}

    <h2 class="mb-4 text-primary">
        <i class="bi bi-send-check"></i> Correos enviados
    </h2>

    <div class="mb-3">
        <a asp-action="UsuariosParaCorreo" asp-controller="Correos" class="btn btn-outline-primary">
            <i class="bi bi-arrow-left-circle me-1"></i> Volver a usuarios
        </a>
    </div>

    <div class="card shadow-sm mb-4">
        <div class="card-header bg-info text-white">
            <strong>Historial de correos</strong>
        </div>
        <div class="card-body">
            @if (Model != null && Model.Any())
            {
                <table class="table table-striped table-hover">
                    <thead class="table-light">
                        <tr>
                            <th>Para</th>
                            <th>Asunto</th>
                            <th>Mensaje</th>
                            <th>Fecha de envío</th>
                            <th>Enviado por</th>
                        </tr>
                    </thead>
                    <tbody>
                    @foreach (var c in Model)
                    {
                        <tr>
                            <td>@c.Destinatario</td>
                            <td>@c.Asunto</td>
                            <td>
                                @(c.Cuerpo?.Length > 100 ? c.Cuerpo.Substring(0, 100) + "..." : c.Cuerpo)
                            </td>
                            <td>@c.FechaEnvio.ToString("dd/MM/yyyy HH:mm")</td>
                            <td>@c.NombreRemitente</td>
                        </tr>
                    }

                    </tbody>
                </table>
            }
            else
            {
                <div class="alert alert-info">
                    <i class="bi bi-inbox"></i> No hay correos enviados registrados.
                </div>
            }
        </div>
    </div>



@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}
