@* Parcial SIDEBAR — se renderiza desde _Layout *@
@{
    Layout = null;

    // Toma el controlador actual para marcar activo
    var ctrl = (ViewContext.RouteData.Values["controller"]
                ?? ViewContext.RouteData.Values["Controller"]
                ?? "").ToString().ToLower();

    // Verifica si el submenú de seguridad debe estar abierto
    var seguridadActiva = ctrl == "usuarios" || ctrl == "roles" || ctrl == "permisos" || ctrl == "rol_permisos";

    var rolId = Context.Session.GetInt32("RolId"); // ✅ Leer el rol actual
}

<aside class="dashboard-sidebar" id="sidebar" role="navigation" aria-label="Navegación principal">
    <div class="sidebar-title">Módulos</div>
    <nav class="sidebar-nav">
        <a asp-controller="Home" asp-action="Index"
           class="nav-item @(ctrl == "home" ? "is-active" : "")"
           aria-current="@(ctrl == "home" ? "page" : null)">
            <i class="bi bi-house-door"></i><span>Inicio</span>
        </a>

        <a asp-controller="Crear_Contraseñas" asp-action="Index"
           class="nav-item @(ctrl == "credenciales" ? "is-active" : "")"
           aria-current="@(ctrl == "credenciales" ? "page" : null)">
            <i class="bi bi-key"></i><span>Credenciales</span>
        </a>

        <a asp-controller="Auditoria" asp-action="Index"
           class="nav-item @(ctrl == "auditoria" ? "is-active" : "")"
           aria-current="@(ctrl == "auditoria" ? "page" : null)">
            <i class="bi bi-activity"></i><span>Auditoría</span>
        </a>

        <div class="nav-item submenu-toggle" onclick="toggleSeguridad()">
            <i class="bi bi-shield-lock"></i><span>Gestión de Seguridad</span>
        </div>

        <ul id="seguridad-submenu" class="submenu @(seguridadActiva ? "" : "oculto")">
            <li>
                <a asp-controller="Usuarios" asp-action="Index" class="nav-item @(ctrl == "usuarios" ? "is-active" : "")">
                    <i class="bi bi-person"></i><span>Usuarios</span>
                </a>
            </li>
            <li>
                <a asp-controller="Roles" asp-action="Index" class="nav-item @(ctrl == "roles" ? "is-active" : "")">
                    <i class="bi bi-shield"></i><span>Roles</span>
                </a>
            </li>
            <li>
                <a asp-controller="Permisos" asp-action="Index" class="nav-item @(ctrl == "permisos" ? "is-active" : "")">
                    <i class="bi bi-lock"></i><span>Permisos</span>
                </a>
            </li>
            <li>
                @* ✅ Mostrar solo si el rol es SuperAdmin *@
                @if (rolId == 1)
                {
                <li>
                    <a asp-controller="Rol_permisos" asp-action="SeleccionarRol"
                       class="nav-item @(ctrl == "rol_permisos" ? "is-active" : "")">
                        <i class="bi bi-list-check"></i><span>Asignar Permisos a Rol</span>
                    </a>
                </li>
                }
        </ul>

        <a asp-controller="Configuracion" asp-action="Index"
           class="nav-item @(ctrl == "configuracion" ? "is-active" : "")"
           aria-current="@(ctrl == "configuracion" ? "page" : null)">
            <i class="bi bi-gear"></i><span>Configuración</span>
        </a>

        <a asp-controller="Ayuda" asp-action="Index"
           class="nav-item @(ctrl == "ayuda" ? "is-active" : "")"
           aria-current="@(ctrl == "ayuda" ? "page" : null)">
            <i class="bi bi-question-circle"></i><span>Ayuda</span>
        </a>
    </nav>
</aside>
